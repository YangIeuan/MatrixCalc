# 矩阵与矩阵相乘

矩阵与矩阵相乘涉及三个分量的遍历：`row_A = i`, `col_A = row_B = k`, `col_B = j`，因此矩阵相乘涉及到三重遍历，不同的遍历顺序会引出不同的算法，下面依次展开来看：

ikj型：最外层循环是`$A$`的行，最内层的循环是矩阵$`B`$的列，因此更新最慢的是$`C`$的行，更新最快的是$`C`$的列，因此按向量形式表示为：
```matlab
for i = 1 : m
    for k = 1 : p
        C(i,:) = A(i,k)B(k,:) + C(i,:)
    end
end
```
可以看出，最内层循环表示成了SAXPY运算。

ijk型：最外层循环是$`A`$的行，最内层的循环是矩阵$`B`$的行，因此更新最慢的是$`C`$的行，更新最快的是中间变量（乘积运算），按向量形式表示为：
```matlab
for i = 1 : m
    for j = 1 : n
        C(i,j) = A(i,:)B(:,j) + C(i, j)    
    end
end
```
可以看出，最内层循环表示成了点积运。

kij型：最外层循环是$`B`$的行，最内层的循环是矩阵$`B`$的列，因此更新最慢的是中间变量（乘积运算），更新最快的是$`C`$的列，无法按向量形式表示，以矩阵形式表示：
```matlab
for k = 1 : p
    C = A(:,k)B(k,:) + C
end
```
可以看出，内部两层表示为秩1修正。

kji型：最外层循环是$`B`$的行，最内层的循环是矩阵$`A`$的行，因此更新最慢的是中间变量（乘积运算），更新最快的是$`C`$的行，无法按向量形式表示，以矩阵形式表示：
```matlab
for k = 1 : p
    C = A(:,k)B(k,:) + C
end
```
可以看出，内部两层表示为秩1修正。

jik型：最外层循环是$`B`$的列，最内层的循环是矩阵$`B`$的行，因此更新最慢的是$`C`$的列，更新最快的是中间变量（乘积运算），以向量形式表示：
```matlab
for j = 1 : n
    for i = 1 : m
        C(i,j) = A(i,:)B(:,j) + C(i, j)
    end
end
```
可以看出，最内层循环表示成了点积运。


jki型：最外层循环是`$B$`的列，最内层的循环是矩阵$`A`$的列行，因此更新最慢的是$`C`$的列，更新最快的是$`C`$的行，因此按向量形式表示为：
```matlab
for j = 1 : n
    for k = 1 : p
        C(:,j) = A(:,k)B(k,j) + C(:,j)
    end
end
```
可以看出，最内层循环表示成了SAXPY运算。

综上，可以看出，总共六种型，三类算法，列出表格如下：


|序号|型号|类型|
|--|--|--|
|1|ikj|SAXPY|
|2|ijk|点积|
|3|kij|秩1修正|
|4|kji|秩1修正|
|5|jik|点积|
|6|jki|SAXPY|
---
[父目录:矩阵乘法](../ReadME.md)